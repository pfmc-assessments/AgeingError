<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Write a specifications file for the AgeingError package — write_specs_file • AgeingError</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Write a specifications file for the AgeingError package — write_specs_file"><meta name="description" content="The resulting file has the format required by the load_specs() function.
In the future, this step could be bypassed by creating the list output
from load_specs() directly.
This function is based on a subset of the RunFn() function in the older ADMB
version of this package."><meta property="og:description" content="The resulting file has the format required by the load_specs() function.
In the future, this step could be bypassed by creating the list output
from load_specs() directly.
This function is based on a subset of the RunFn() function in the older ADMB
version of this package."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">AgeingError</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">2.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/getting_started.html">Estimating ageing error using the TMB model written by André Punt</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/pfmc-assessments/AgeingError/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Write a specifications file for the AgeingError package</h1>
      <small class="dont-index">Source: <a href="https://github.com/pfmc-assessments/AgeingError/blob/main/R/write_specs_file.R" class="external-link"><code>R/write_specs_file.R</code></a></small>
      <div class="d-none name"><code>write_specs_file.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>The resulting file has the format required by the <code><a href="load_specs.html">load_specs()</a></code> function.
In the future, this step could be bypassed by creating the list output
from <code><a href="load_specs.html">load_specs()</a></code> directly.
This function is based on a subset of the RunFn() function in the older ADMB
version of this package.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">write_specs_file</span><span class="op">(</span></span>
<span>  dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/getwd.html" class="external-link">getwd</a></span><span class="op">(</span><span class="op">)</span>,</span>
<span>  file_name <span class="op">=</span> <span class="st">"data.spc"</span>,</span>
<span>  <span class="va">nreaders</span>,</span>
<span>  biasopt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  sigopt <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  knotages <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-dir">dir<a class="anchor" aria-label="anchor" href="#arg-dir"></a></dt>
<dd><p>Directory where the specifications file will be saved.</p></dd>


<dt id="arg-file-name">file_name<a class="anchor" aria-label="anchor" href="#arg-file-name"></a></dt>
<dd><p>Name of the specifications file.</p></dd>


<dt id="arg-biasopt">biasopt<a class="anchor" aria-label="anchor" href="#arg-biasopt"></a></dt>
<dd><p>A vector with one entry for each reader specifying the
type of bias specific to each reader. Positive values lead to estimated
parameters and negative values are used for shared parameters between
readers. Parameter sharing (mirroring) is common when there
is more than one reader in a lab working together to refine their methods
such that they have matching techniques.
If NULL is passed, the default is <code>rep(0, nreaders)</code> which specifies that
all readers are unbiased.</p>
<p>Possible entries include the following:</p><dl><dt>-0-9+</dt>
<dd><p>Mirror the bias of another reader, where the negative integer
corresponds to the column of the reader that is being mirrored
minus one, e.g., <code>-1</code> causes it to mirror reader 1. Only lower-numbered
readers can be mirrored.</p></dd>

<dt>0</dt>
<dd><p>Unbiased, where at least one reader has to be unbiased.</p></dd>

<dt>1</dt>
<dd><p>Constant coefficient of variation, i.e., a 1-parameter linear
relationship of bias with true age.</p></dd>

<dt>2</dt>
<dd><p>Curvilinear, i.e., a 2-parameter Hollings-form relationship of bias
with true age.</p></dd>


</dl><p>An example entry for the situation where you have seven readers and you
assume that the first reader is unbiased, readers 2-7 have a curvilinear
bias, reader 3 shares parameters with reader 2, reader 5 shares parameters
with reader 4, and reader 7 shares parameters with reader 6 would look
like <code>c(0, 2, -2, 2, -4, 2, -6)</code>.</p></dd>


<dt id="arg-sigopt">sigopt<a class="anchor" aria-label="anchor" href="#arg-sigopt"></a></dt>
<dd><p>A vector with one entry for each reader.
Each entry specifies the functional
form of reading error as a function of true age. Positive values lead to
estimated parameters and negative values are used for shared parameters
between readers.
If NULL is passed, the default is <code>c(1, rep(-1, nreaders - 1))</code> which
specifies a constant CV in ageing error which is shared among all readers.</p>
<p>Possible entries include the following:</p><dl><dt>-0-9+</dt>
<dd><p>Mirror the standard deviation of another reader, where the negative
integer corresponds to the column of the reader that is being
mirrored minus one, e.g., <code>-1</code> causes it to mirror reader 1, for
which data is stored in the second column of <code>Data</code>. This number must
be lower than -1 times the current position in the vector.</p></dd>

<dt>0</dt>
<dd><p>No error. But, there could be potential bias.</p></dd>

<dt>1</dt>
<dd><p>Constant coefficient of variation, i.e., a 1-parameter linear
relationship of the standard deviation with the true age.</p></dd>

<dt>2</dt>
<dd><p>Curvilinear standard deviation, i.e., a 3-parameter Hollings-form
relationship of standard deviation with true age.</p></dd>

<dt>3</dt>
<dd><p>Curvilinear coefficient of variation, i.e., a 3-parameter
Hollings-form relationship of coefficient of variation with true age.</p></dd>

<dt>5</dt>
<dd><p>Spline with estimated slope at beginning and end where the number of
parameters is 2 + number of knots.</p></dd>

<dt>6</dt>
<dd><p>Linear interpolation with a first knot of 1 and a last knot of the
maximum age, i.e., <code>MaxAge</code>.</p></dd>


</dl></dd>


<dt id="arg-knotages">knotages<a class="anchor" aria-label="anchor" href="#arg-knotages"></a></dt>
<dd><p>Ages associated with each knot. This is a necessary input
for <code>sigopt = 5</code> or <code>sigopt = 6</code>. Not implemented in this function yet.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Invisibly returns the path to the specifications file (<code>file.path(dir, file_name)</code>).</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="write_files.html">write_files()</a></code>, <code>write_specs_file()</code>, <code><a href="load_specs.html">load_specs()</a></code></p></div>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ian G. Taylor, James T. Thorson, Ian J. Stewart, Andre E. Punt</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">data_test</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span></span></span>
<span class="r-in"><span>  reader1 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">10</span>, <span class="fl">7</span>, <span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">10</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">7</span>, <span class="fl">7</span>, <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">5</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  reader2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">7</span>, <span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">10</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">7</span>, <span class="fl">7</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span><span class="op">)</span>,</span></span>
<span class="r-in"><span>  reader3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">7</span>, <span class="fl">10</span>, <span class="fl">7</span>, <span class="fl">6</span>, <span class="fl">6</span>, <span class="fl">8</span>, <span class="fl">7</span>, <span class="fl">9</span>, <span class="fl">8</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">5</span>, <span class="fl">6</span>, <span class="fl">7</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">5</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">data_file</span> <span class="op">&lt;-</span> <span class="fu"><a href="write_data_file.html">write_data_file</a></span><span class="op">(</span><span class="va">data_test</span>, dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, file_name <span class="op">=</span> <span class="st">"test.dat"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Input 'dat' doesn't contain a column called 'count'; adding one via tally_repeats()</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Total observations: 20</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Aggregated unique combinations: 12</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Range of observed ages in the data: 5 - 10</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Number of readers: 3</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Max age not specified; using 15 which is the multiple of 5 which is &gt;120% of the observed maximum</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Minus group set to the minimum observed age 5</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Plus group set to the maximum observed age 10</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Reference age not specified; using 7 = floor(median(c(minusage, plusage)))</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Writing data file to /tmp/RtmpGNDuDx/test.dat</span>
<span class="r-in"><span><span class="va">specs_file</span> <span class="op">&lt;-</span> <span class="fu">write_specs_file</span><span class="op">(</span>dir <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/tempfile.html" class="external-link">tempdir</a></span><span class="op">(</span><span class="op">)</span>, nreaders <span class="op">=</span> <span class="fl">3</span>, file_name <span class="op">=</span> <span class="st">"test.spc"</span><span class="op">)</span></span></span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> 'biasopt' not specified; settings all readers to unbiased</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> 'sigopt' not specified; settings all readers to share a constant CV parameter</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Writing specifications file to /tmp/RtmpGNDuDx/test.spc</span>
<span class="r-in"><span><span class="va">data</span> <span class="op">&lt;-</span> <span class="fu"><a href="load_data.html">load_data</a></span><span class="op">(</span>DataFile <span class="op">=</span> <span class="va">data_file</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #BBBB00;">!</span> There are some missing data; the effective sample size calculation may be dubious</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Structure of the data set</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Data set # Entries Reader boolean</span>
<span class="r-msg co"><span class="r-pr">#&gt;</span> <span style="color: #00BBBB;">ℹ</span> Number of rows in NrowStruc 3 = 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ReaderStruc"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3] [,4] [,5]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    3    1    0    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [2,]    1   14    1    2    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [3,]    1    3    1    2    0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 3 1 0 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 14 1 2 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 3 1 2 0</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ReaderSumm"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    0    0    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> ReaderSumm</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> 1 2 3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] "ReaderSumm"</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>      [,1] [,2] [,3]</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1,]    1    2    3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of reads by data set:        3</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Minimum and Maximum Ages:           5   10</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> total cells  256</span>
<span class="r-in"><span><span class="va">specs</span> <span class="op">&lt;-</span> <span class="fu"><a href="load_specs.html">load_specs</a></span><span class="op">(</span><span class="op">)</span></span></span>
<span class="r-wrn co"><span class="r-pr">#&gt;</span> <span class="warning">Warning: </span>cannot open file 'data.spc': No such file or directory</span>
<span class="r-err co"><span class="r-pr">#&gt;</span> <span class="error">Error in file(file, "rt"):</span> cannot open the connection</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Andre E. Punt, Kelli F. Johnson, Ian G. Taylor, Paul Burch.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

